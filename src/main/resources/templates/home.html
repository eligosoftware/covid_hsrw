<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Covid 19 Info Page</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    -->
    <script
            src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.24/css/dataTables.bootstrap4.min.css">
    <script src="https://maps.google.com/maps/api/js?key=AIzaSyDst0N8AWu46dF6XWzZHxrEs82eBBQR4_k"></script>
    <script src="https://code.jscharting.com/latest/jscharting.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap4.min.js"></script>

    <link rel="shortcut icon" type="image/png" th:href="@{/img/favicon.png}"/>
    <!--PLEASE NOTE: As of June 22 2016, Google Maps require an API key.
    * GET YOUR API KEY FROM ... https://developers.google.com/maps/documentation/javascript/get-api-key
    * ONCE YOU GET THE KEY, REPLACE 'js?sensor=false' IN THE ABOVE URL WITH "js?key=YOUR_NEW_API_KEY".-->
    <style>
    .overlay{
        display: none;
        position: fixed;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        z-index: 999;
        background: rgba(255,255,255,0.8)
        url("/img/loader.gif") center no-repeat;
    }
    /* Turn off scrollbar when body element has the loading class */
    body.loading{
        overflow: hidden;
    }
    /* Make spinner image visible when body element has the loading class */
    body.loading .overlay{
        display: block;
    }
</style>
</head>

<body>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div class="bg-light p-5 rounded-lg m-3">
                <h1 class="display-4" th:text="${totalReportedCases}"></h1>
                <p class="lead">Total cases reported as of today</p>
                <p>
                    <span>New cases since previous day:</span>
                    <span th:text="${totalNewCases}"></span>
                </p>

            </div>
        </div>
    </div>
    <div class="row">
    <select class="form-select"  aria-label="Default select example">
        <option selected value="0">World</option>
        <option value="1">Europe</option>
        <option value="2">North America</option>
        <option value="3">South America</option>
        <option value="4">Asia</option>
        <option value="5">Oceania</option>
        <option value="6">Africa</option>
    </select>
    </div>
    <div class="row">
        <div class="col">
            <div id="mapContainer" style="width:100%;height:650px;"></div>
        </div>
    </div>
    <br/>
    <div class="row">

        <div class="col">

    <table class="table table-striped table-bordered mydatatable">
    <thead>

    <tr>
        <th>Country</th>
       <!-- <th>Province</th>-->
        <!--  <th>City</th>>-->
         <th>Total stats</th>
         <th>New cases</th>
     </tr>
     </thead>
     <tr th:each="locationStat : ${locationStats}">
         <td th:text="${locationStat.region.name}"></td>
         <!-- <td th:text="${locationStat.region.province}"></td>-->
         <!-- <td th:text="${locationStat.city==null} ? '':${locationStat.city.name}"></td>-->
         <td th:text="${locationStat.totalConfirmed}">0</td>
         <td th:text="${locationStat.confirmed}">0</td>
     </tr>

         <tfoot>
         <tr>
             <th>Country</th>
             <!--<th>Province</th>-->
             <!--<th>City</th>-->
             <th>Total stats</th>
             <th>New cases</th>
         </tr>
         </tfoot>
 </table>
 </div>

     </div>





<br/>
    <h1>Numbers</h1>
<div class="row">
    <div class="container">
        <div class="col-md-6">
            <div class="bg-light p-5 rounded-lg m-3">

                <div>
                    <input type="radio" id="world" name="type" value="1" checked>World
                    <input type="radio" id="continents" name="type" value="2" >Continents
                    <input type="radio" id="countries" name="type" value="3" >Countries<br/>

                </div>
                <div>
                    <select id="describe">
                    </select>
                </div>
                <h1 id="f_rate" class="display-4" th:text="${fatalityRate}"></h1>
                <p class="lead">Fatality rate</p>
            </div>
        </div>
        <div class="card-deck">
            <div class="card text-center">
                <div class="card-block text-light bg-primary">
                    <h4 class="card-title">Last Day Cases</h4>
                    <p id="new_cases" class="card-text">
                        [[${new_cases}]]
                    </p>
                </div>
            </div>

            <div class="card text-center">
                <div class="card-block text-light bg-dark">
                    <h4 class="card-title">Last Day Deaths</h4>
                    <p id="new_deaths" class="card-text">
                        [[${new_deaths}]]
                    </p>
                </div>
            </div>

            <div class="card text-center">
                <div class="card-block text-light bg-success">
                    <h4 class="card-title">Last Day Recovered</h4>
                    <p id="new_recovered" class="card-text">
                        [[${new_recovered}]]
                    </p>
                </div>
            </div>

            <div class="card text-center">
                <div class="card-block text-dark bg-warning">
                    <h4 class="card-title">Last Day Active</h4>
                    <p id="new_active" class="card-text">
                        [[${new_active}]]&nbsp;&nbsp;&nbsp;&#8432;
                    </p>
                </div>
            </div>

        </div>
        <div class="card-deck mt-5">
            <div class="card text-center">
                <div class="card-block text-light bg-primary">
                    <h4 class="card-title">Total Cases</h4>
                    <p id="total_cases" class="card-text">
                        [[${total_cases}]]
                    </p>
                </div>
            </div>

            <div class="card text-center">
                <div class="card-block text-light bg-dark">
                    <h4 class="card-title">Total Deaths</h4>
                    <p id="total_deaths" class="card-text">
                        [[${total_deaths}]]
                    </p>
                </div>
            </div>

            <div class="card text-center">
                <div class="card-block text-light bg-success">
                    <h4 class="card-title">Total Recovered</h4>
                    <p id="total_recovered" class="card-text">
                        [[${total_recovered}]]
                    </p>
                </div>
            </div>

            <div class="card text-center">
                <div class="card-block text-dark bg-warning">
                    <h4 class="card-title">Total Active</h4>
                    <p id="total_active" class="card-text">
                        [[${total_active}]]&nbsp;&nbsp;&nbsp;&#8432;
                    </p>
                </div>
            </div>
        </div>
</div>
</div>
<br/>
    <span style="font-size:15px; font-style: italic;">&#8432; - the negative number means, that more people recovered than infected</span><br/>
    <h1>Charts</h1>
<div class="row">
    <div class="col-sm">
 <div id="chartDiv" style="max-width: 740px;height: 290px;margin: 0px auto">
</div>
    </div>
    <div class="col-sm">
    <div id="chartDiv2" style="max-width: 740px;height: 400px;margin: 0px auto">
    </div>
    </div>
</div>
    <div class="row">
        <div class="col-sm">
    <div id="chartDiv3" style="max-width: 740px;height: 400px;margin: 0px auto">
    </div>
    </div>
        <div class="col-sm">
            <div id="chartDiv4" style="max-width: 740px;height: 400px;margin: 0px auto">
            </div>
        </div>
    </div>
    <br/>
    <div class="row">
        <div class="col-sm">
            <div id="chartDiv5" style="max-width: 740px;height: 400px;margin: 0px auto">
            </div>
        </div>
    </div>
</div>
<script>
  var listA = [{name:'Europe', value:'europe'}, {name:'North America', value:'north_america'},{name:'South America', value:'south_america'},{name:'Asia', value:'asia'}, {name:'Oceania', value:'oceania'}, {name:'Africa', value:'africa'}];
  var listB_europe =[{name:'Albania',value:'Albania'},{name:'Andorra',value:'Andorra'},{name:'Armenia',value:'Armenia'},{name:'Austria',value:'Austria'},{name:'Azerbaijan',value:'Azerbaijan'},{name:'Belarus',value:'Belarus'},{name:'Belgium',value:'Belgium'},{name:'Bosnia and Herzegovina',value:'Bosnia and Herzegovina'},{name:'Bulgaria',value:'Bulgaria'},{name:'Croatia',value:'Croatia'},{name:'Cyprus',value:'Cyprus'},{name:'Channel Islands',value:'Channel Islands'},{name:'Czechia',value:'Czechia'},{name:'Denmark',value:'Denmark'},{name:'Estonia',value:'Estonia'},{name:'Faroe Islands',value:'Faroe Islands'},{name:'Finland',value:'Finland'},{name:'France',value:'France'},{name:'Georgia',value:'Georgia'},{name:'Germany',value:'Germany'},{name:'Gibraltar',value:'Gibraltar'},{name:'Guernsey',value:'Guernsey'},{name:'Greece',value:'Greece'},{name:'Holy See',value:'Holy See'},{name:'Hungary',value:'Hungary'},{name:'Iceland',value:'Iceland'},{name:'Ireland',value:'Ireland'},{name:'Italy',value:'Italy'},{name:'Jersey',value:'Jersey'},{name:'Kosovo',value:'Kosovo'},{name:'Latvia',value:'Latvia'},{name:'Liechtenstein',value:'Liechtenstein'},{name:'Lithuania',value:'Lithuania'},{name:'Luxembourg',value:'Luxembourg'},{name:'Mayotte',value:'Mayotte'},{name:'Malta',value:'Malta'},{name:'Moldova',value:'Moldova'},{name:'MS Zaandam',value:'MS Zaandam'},{name:'Monaco',value:'Monaco'},{name:'Montenegro',value:'Montenegro'},{name:'Netherlands',value:'Netherlands'},{name:'North Macedonia',value:'North Macedonia'},{name:'Norway',value:'Norway'},{name:'Poland',value:'Poland'},{name:'Portugal',value:'Portugal'},{name:'Romania',value:'Romania'},{name:'Russia',value:'Russia'},{name:'San Marino',value:'San Marino'},{name:'Serbia',value:'Serbia'},{name:'Slovakia',value:'Slovakia'},{name:'Slovenia',value:'Slovenia'},{name:'Spain',value:'Spain'},{name:'Sweden',value:'Sweden'},{name:'Switzerland',value:'Switzerland'},{name:'Turkey',value:'Turkey'},{name:'Ukraine',value:'Ukraine'},{name:'United Kingdom',value:'United Kingdom'}];
   var listB_asia =[{name:'Afghanistan',value:'Afghanistan'},{name:'Bahrain',value:'Bahrain'},{name:'Bangladesh',value:'Bangladesh'},{name:'Bhutan',value:'Bhutan'},{name:'Brunei',value:'Brunei'},{name:'Burma',value:'Burma'},{name:'Cambodia',value:'Cambodia'},{name:'China',value:'China'},{name:'India',value:'India'},{name:'Indonesia',value:'Indonesia'},{name:'Iran',value:'Iran'},{name:'Iraq',value:'Iraq'},{name:'Israel',value:'Israel'},{name:'West Bank and Gaza',value:'West Bank and Gaza'},{name:'Japan',value:'Japan'},{name:'Jordan',value:'Jordan'},{name:'Kazakhstan',value:'Kazakhstan'},{name:'Korea',value:'Korea'},{name:' South',value:' South'},{name:'Kyrgyzstan',value:'Kyrgyzstan'},{name:'Kuwait',value:'Kuwait'},{name:'Laos',value:'Laos'},{name:'Lebanon',value:'Lebanon'},{name:'Malaysia',value:'Malaysia'},{name:'Macao SAR',value:'Macao SAR'},{name:'Maldives',value:'Maldives'},{name:'Mongolia',value:'Mongolia'},{name:'Nepal',value:'Nepal'},{name:'Oman',value:'Oman'},{name:'Pakistan',value:'Pakistan'},{name:'Philippines',value:'Philippines'},{name:'Qatar',value:'Qatar'},{name:'Saudi Arabia',value:'Saudi Arabia'},{name:'Singapore',value:'Singapore'},{name:'Sri Lanka',value:'Sri Lanka'},{name:'Syria',value:'Syria'},{name:'Taiwan',value:'Taiwan'},{name:'Tajikistan',value:'Tajikistan'},{name:'Thailand',value:'Thailand'},{name:'Timor-Leste',value:'Timor-Leste'},{name:'Turkmenistan',value:'Turkmenistan'},{name:'Taipei and environs',value:'Taipei and environs'},{name:'United Arab Emirates',value:'United Arab Emirates'},{name:'Uzbekistan',value:'Uzbekistan'},{name:'Vietnam',value:'Vietnam'},{name:'Yemen',value:'Yemen'}];
   var listB_north_america =[{name:'Antigua and Barbuda',value:'Antigua and Barbuda'},{name:'Aruba',value:'Aruba'},{name:'Bahamas',value:'Bahamas'},{name:'Barbados',value:'Barbados'},{name:'Belize',value:'Belize'},{name:'Canada',value:'Canada'},{name:'Cayman Islands',value:'Cayman Islands'},{name:'Costa Rica',value:'Costa Rica'},{name:'Cuba',value:'Cuba'},{name:'Dominica',value:'Dominica'},{name:'Dominican Republic',value:'Dominican Republic'},{name:'El Salvador',value:'El Salvador'},{name:'Greenland',value:'Greenland'},{name:'Grenada',value:'Grenada'},{name:'Guadeloupe',value:'Guadeloupe'},{name:'Guatemala',value:'Guatemala'},{name:'Haiti',value:'Haiti'},{name:'Honduras',value:'Honduras'},{name:'Jamaica',value:'Jamaica'},{name:'Martinique',value:'Martinique'},{name:'Mexico',value:'Mexico'},{name:'Nicaragua',value:'Nicaragua'},{name:'Panama',value:'Panama'},{name:'Puerto Rico',value:'Puerto Rico'},{name:'Saint Kitts and Nevis',value:'Saint Kitts and Nevis'},{name:'Saint Lucia',value:'Saint Lucia'},{name:'Saint Martin',value:'Saint Martin'},{name:'Saint Vincent and the Grenadines',value:'Saint Vincent and the Grenadines'},{name:'Saint Barthelemy',value:'Saint Barthelemy'},{name:'Trinidad and Tobago',value:'Trinidad and Tobago'},{name:'US',value:'US'}];
  var listB_south_america =[{name:'Argentina',value:'Argentina'},{name:'Bolivia',value:'Bolivia'},{name:'Brazil',value:'Brazil'},{name:'Chile',value:'Chile'},{name:'Colombia',value:'Colombia'},{name:'Curacao',value:'Curacao'},{name:'Ecuador',value:'Ecuador'},{name:'French Guiana',value:'French Guiana'},{name:'Guyana',value:'Guyana'},{name:'Paraguay',value:'Paraguay'},{name:'Peru',value:'Peru'},{name:'Suriname',value:'Suriname'},{name:'Uruguay',value:'Uruguay'},{name:'Venezuela',value:'Venezuela'}];
    var listB_africa =[{name:'Algeria',value:'Algeria'},{name:'Angola',value:'Angola'},{name:'Benin',value:'Benin'},{name:'Botswana',value:'Botswana'},{name:'Tanzania',value:'Tanzania'},{name:'Burkina Faso',value:'Burkina Faso'},{name:'Western Sahara',value:'Western Sahara'},{name:'Burundi',value:'Burundi'},{name:'Cabo Verde',value:'Cabo Verde'},{name:'Cameroon',value:'Cameroon'},{name:'Central African Republic',value:'Central African Republic'},{name:'Comoros',value:'Comoros'},{name:'Chad',value:'Chad'},{name:'Malawi',value:'Malawi'},{name:'Sierra Leone',value:'Sierra Leone'},{name:'Sao Tome and Principe',value:'Sao Tome and Principe'},{name:'Seychelles',value:'Seychelles'},{name:'Congo (Brazzaville)',value:'Congo (Brazzaville)'},{name:'Congo (Kinshasa)',value:'Congo (Kinshasa)'},{name:'Cote d\'Ivoire',value:'Cote d\'Ivoire'},{name:'Djibouti',value:'Djibouti'},{name:'Egypt',value:'Egypt'},{name:'Equatorial Guinea',value:'Equatorial Guinea'},{name:'Guinea',value:'Guinea'},{name:'Guinea-Bissau',value:'Guinea-Bissau'},{name:'Eritrea',value:'Eritrea'},{name:'Eswatini',value:'Eswatini'},{name:'South Sudan',value:'South Sudan'},{name:'Reunion',value:'Reunion'},{name:'Ethiopia',value:'Ethiopia'},{name:'Gabon',value:'Gabon'},{name:'Gambia',value:'Gambia'},{name:'Ghana',value:'Ghana'},{name:'Kenya',value:'Kenya'},{name:'Liberia',value:'Liberia'},{name:'Libya',value:'Libya'},{name:'Lesotho',value:'Lesotho'},{name:'Madagascar',value:'Madagascar'},{name:'Mali',value:'Mali'},{name:'Mauritania',value:'Mauritania'},{name:'Mauritius',value:'Mauritius'},{name:'Morocco',value:'Morocco'},{name:'Mozambique',value:'Mozambique'},{name:'Namibia',value:'Namibia'},{name:'Niger',value:'Niger'},{name:'Nigeria',value:'Nigeria'},{name:'Rwanda',value:'Rwanda'},{name:'Senegal',value:'Senegal'},{name:'Somalia',value:'Somalia'},{name:'South Africa',value:'South Africa'},{name:'Sudan',value:'Sudan'},{name:'Togo',value:'Togo'},{name:'Tunisia',value:'Tunisia'},{name:'Uganda',value:'Uganda'},{name:'Zambia',value:'Zambia'},{name:'Zimbabwe',value:'Zimbabwe'}];
  var listB_oceania =[{name:'Australia',value:'Australia'},{name:'Fiji',value:'Fiji'},{name:'Guam',value:'Guam'},{name:'New Zealand',value:'New Zealand'},{name:'Papua New Guinea',value:'Papua New Guinea'},{name:'Kiribati',value:'Kiribati'},{name:'Marshall Islands',value:'Marshall Islands'},{name:'Solomon Islands',value:'Solomon Islands'},{name:'Vanuatu',value:'Vanuatu'}];

</script>
 <script>
     $('.mydatatable').DataTable({
         order:[
             [0,'asc']
             ],
         lengthMenu: [
            [5,10,25,50,-1],[5,10,25,50,"All"]
         ],
         scrollY: 400,
         scrollCollapse: true,
         pagingType: 'full_numbers'
     });
 </script>

<script>



var js_scr="[[${js_script}]]";
js_scr=js_scr.replaceAll("&#39;","\'");
js_scr=js_scr.replaceAll("&lt;","<");
js_scr=js_scr.replaceAll("&gt;",">");

//console.log(js_scr);

eval(js_scr);

var js_scr2="[[${js_script2}]]";
js_scr2=js_scr2.replaceAll("&#39;","\'");
js_scr2=js_scr2.replaceAll("&lt;","<");
js_scr2=js_scr2.replaceAll("&gt;",">");

//console.log(js_scr);

eval(js_scr2);

var js_scr3="[[${js_script3}]]";
js_scr3=js_scr3.replaceAll("&#39;","\'");
js_scr3=js_scr3.replaceAll("&lt;","<");
js_scr3=js_scr3.replaceAll("&gt;",">");

//console.log(js_scr);

eval(js_scr3);

var js_scr4="[[${js_script4}]]";
js_scr4=js_scr4.replaceAll("&#39;","\'");
js_scr4=js_scr4.replaceAll("&lt;","<");
js_scr4=js_scr4.replaceAll("&gt;",">");

//console.log(js_scr);
//console.log(js_scr4);
eval(js_scr4);

var js_scr5="[[${js_script5}]]";
js_scr5=js_scr5.replaceAll("&#39;","\'");
js_scr5=js_scr5.replaceAll("&lt;","<");
js_scr5=js_scr5.replaceAll("&gt;",">");

//console.log(js_scr);
//console.log(js_scr5);
eval(js_scr5);

</script>

<script>
  $(document).ready( function() {

  $('#describe').on('change', function() {

    $("body").addClass("loading");
  $.ajax({//1
	url: '/updateNumbers',
	method: 'post',
	data: {country: this.value},
	success: function(data){//2

        //console.log(data);

	    var data = data.replace(",]", "]");
        //console.log(data);

		if (data!="error"){//3
		    //console.log(data);
            var obj = JSON.parse(data);
            //console.log(obj.country);
            document.getElementById('new_cases').innerHTML=numberWithSpaces(obj.new_cases);
            document.getElementById('new_active').innerHTML=numberWithSpaces(obj.new_active)+"&nbsp;&nbsp;&nbsp;&#8432;";
            document.getElementById('new_recovered').innerHTML=numberWithSpaces(obj.new_recovered);
            document.getElementById('new_deaths').innerHTML=numberWithSpaces(obj.new_deaths);
            document.getElementById('total_cases').innerHTML=numberWithSpaces(obj.total_cases);
            document.getElementById('total_deaths').innerHTML=numberWithSpaces(obj.total_deaths);
            document.getElementById('total_recovered').innerHTML=numberWithSpaces(obj.total_recovered);
            document.getElementById('total_active').innerHTML=numberWithSpaces(obj.total_active)+"&nbsp;&nbsp;&nbsp;&#8432;";
            document.getElementById('f_rate').innerHTML=obj.fatalityRate;



            var chart1=obj.chart1;
            if(chart1.update){//4
            var js_chart1="var chart = JSC.chart('chartDiv', {debug: true,legend_position: 'inside left bottom',defaultSeries: { type: 'pie', pointSelection: true },defaultPoint_label: {text: '<b>%name</b>',placement: 'auto',autoHide: false},toolbar_items: {Mode: {margin: 10,type: 'select',events_change: setMode,items: 'enum_placement'},'Auto Hide': { type: 'checkbox', events_change: setAutoHide }},title_label_text: 'Top 10 countries by case numbers',yAxis: { label_text: 'Cases', formatString: 'n' },series: [{name: 'Countries', points: [";

             for (i = 0; i < chart1.values.length-1; i++) {//5
                var region=chart1.values[i];
              js_chart1 += "{ name: '"+region.name+"', y: "+region.y+" },";
              }//5
               var region=chart1.values[chart1.values.length-1];
              js_chart1 += "{ name: '"+region.name+"', y: "+region.y+" }";

            js_chart1+="]}]});function setMode(val) { chart.options({ defaultPoint: { label: { placement: val } } }); } function setAutoHide(val) {chart.options({ defaultPoint: { label: { autoHide: val } } }); }";
            eval(js_chart1);
            }//4
            var chart2=obj.chart2;
            if(chart2.update){//6
            var js_chart2="var chart2 = JSC.chart('chartDiv2', {debug: true,type: 'line',title_label_text: 'Line Series Types',legend_position: 'inside bottom right',toolbar_items: {'Line Type': {type: 'select',label_style_fontSize: 13,margin: 5,items: 'Line,Step,Spline',events_change: function(val) {chart2.series().options({ type: val });}}},xAxis: { scale_type: 'time' },series: [{name: 'New Cases',points: [";

             for (i = 0; i < chart2.values.length-1; i++) {//7
                var region=chart2.values[i];
              js_chart2 += "['"+region.key+"',"+region.value+"],";
              }//7
               var region=chart2.values[chart2.values.length-1];
              js_chart2 += "['"+region.key+"',"+region.value+"]";

            js_chart2+="]}]});";
           eval(js_chart2);
        }//6

        var chart3=obj.chart3;
            if(chart3.update){//6
            var js_chart3="JSC.chart('chartDiv3', {debug: true,defaultSeries_type: 'column',title_label_text:'Top 10 Countries by Infections per 100.000',yAxis:{defaultTick_enabled:false,scale_range_padding:.15},legend_visible:false,toolbar_visible:false,series:[{name:'Infections per 100.000 population',color:'turquoise',defaultPoint:{label:{text:'%value'}},points:[";

             for (i = 0; i < chart3.values.length-1; i++) {//7
                var region=chart3.values[i];
              js_chart3 += "{ name: '"+region.key+"', y: "+region.value+"},";
              }//7
               var region=chart3.values[chart3.values.length-1];
              js_chart3 += "{ name: '"+region.key+"', y: "+region.value+" }";

            js_chart3+="]}]});";
            //console.log(js_chart3);
           eval(js_chart3);
        }//6

var chart4=obj.chart4;
            if(chart4.update){//6
            var js_chart4="var chart4 = JSC.chart('chartDiv4', {debug: true,type: 'line',title_label_text: 'New Cases to Recovered Cases',legend_visible: false,xAxis_scale_type: 'time',yAxis_markers: [{ value: 1, color: 'red', label_text: 'The risk line' }],series: [{name: 'Value',palette: {pointValue: '%yValue',stops: [  [0, '%color', 0.7],[1, 'red']]},points: [";

             for (i = 0; i < chart4.values.length-1; i++) {//7
                var region=chart4.values[i];
              js_chart4 += "['"+region.key+"',"+region.value+"],";
              }//7
               var region=chart4.values[chart4.values.length-1];
              js_chart4 += "['"+region.key+"',"+region.value+"]";

            js_chart4+="]}]});";
            //console.log(js_chart4);
           eval(js_chart4);
        }//6

var chart5=obj.chart5;
            if(chart5.update){//6
            var js_chart5="var chart5 = JSC.chart('chartDiv5', {debug: true,defaultSeries_type: 'column',title_label_text:'Death toll for the last 14 days',yAxis:{defaultTick_enabled:false,scale_range_padding:.15},legend_visible:false,toolbar_visible:false,series:[{name:'Number of deaths',color:'black',defaultPoint:{label:{text:'%value'}},points:[";

             for (i = 0; i < chart5.values.length-1; i++) {//7
                var region=chart5.values[i];
              js_chart5 += "['"+region.key+"',"+region.value+"],";
              }//7
               var region=chart5.values[chart5.values.length-1];
              js_chart5 += "['"+region.key+"',"+region.value+"]";

            js_chart5+="]}]});";
            //console.log(js_chart5);
           eval(js_chart5);
        }//6

		}//3

		else{//8
		alert("No data for the selected region");
		      document.getElementById('new_cases').innerHTML="-";
            document.getElementById('new_active').innerHTML="-";
            document.getElementById('new_recovered').innerHTML="-";
            document.getElementById('new_deaths').innerHTML="-";
            document.getElementById('total_cases').innerHTML="-";
            document.getElementById('total_deaths').innerHTML="-";
            document.getElementById('total_recovered').innerHTML="-";
            document.getElementById('total_active').innerHTML="-";
            document.getElementById('f_rate').innerHTML="-";

		}//8
		$("body").removeClass("loading");
	}//2
});
});
  $('#describe').hide();
    $('#world').bind('click', function() {
      $('#describe').empty();
       $('#describe').hide();
       document.location.reload(true)
    });

    $('#countries').bind('click', function() {

      $('#describe').empty();
      $('#describe').show();
      $('#describe').append('<optgroup label="Europe">');
      $.each(listB_europe, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
      $('#describe').append('</optgroup>');

      $('#describe').append('<optgroup label="North America">');
      $.each(listB_north_america, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
      $('#describe').append('</optgroup>');

      $('#describe').append('<optgroup label="South America">');
      $.each(listB_south_america, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
      $('#describe').append('</optgroup>');

      $('#describe').append('<optgroup label="Asia">');
      $.each(listB_asia, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
      $('#describe').append('</optgroup>');

      $('#describe').append('<optgroup label="Oceania">');
      $.each(listB_oceania, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
      $('#describe').append('</optgroup>');

        $('#describe').append('<optgroup label="Africa">');
      $.each(listB_africa, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
      $('#describe').append('</optgroup>');
    });

    $('#continents').bind('click', function(){
      $('#describe').empty();
      $('#describe').show();
      $.each(listA, function(index, value) {
        $('#describe').append('<option value="'+value.value+'">'+value.name+'</option>');
      });
    });
  });
</script>
<script>
$( "select" )
  .change(function () {

    var point;
    switch(this.value){
    case "1": // Europe
    point = new google.maps.LatLng(55.4833, 28.8000);
    break;
    case "2": // N Am
    point = new google.maps.LatLng(48.10, -100.10);
    break;
    case "3": // S Am
    point = new google.maps.LatLng(-26.085429, -60.535785);
    break;
    case "4": // Asia
    point = new google.maps.LatLng(43.4037,87.1952 );
    break;
    case "5": // Oceania
    point = new google.maps.LatLng(30, 140);
    break;
    case "6": // Africa
    point = new google.maps.LatLng(1.300000 , 15);
    break;
    case "0":
    point = new google.maps.LatLng(40.52, 34.34);
    break;
    }
    map.setCenter(point);
    if(this.value=="0")
    map.setZoom(2);
    else
        map.setZoom(4);
  });
</script>
 <script>
     // LOCATION IN LATITUDE AND LONGITUDE.
     var center = new google.maps.LatLng(40.52, 34.34);
     var map;
     function initialize() {
         // MAP ATTRIBUTES.
         var mapAttr = {
             center: center,
             zoom: 2,
             mapTypeId: google.maps.MapTypeId.TERRAIN
         };

         // THE MAP TO DISPLAY.
         map = new google.maps.Map(document.getElementById("mapContainer"), mapAttr);
 var max_stat=[[${max_stat}]];
 var s="[[${json}]]".replaceAll("&quot;","\"");
          //console.log(s);
         var obj=JSON.parse(s);

        for (var i = 0; i < obj.length; i++){
   var obj2 = obj[i];
   var lat=0;
   var long=0;
   var ltc=0;
   var country="";
  // var province="";
  // var city="";

   for (var key in obj2){
   if(key=="lat")
     lat=obj2[key];
     if(key=="long")
     long=obj2[key];
     if(key=="country")
     country=obj2[key];
    // if(key=="province")
    // province=obj2[key];
    // if(key=="city")
    // city=obj2[key];
    if(key=="ltc")
     ltc=obj2[key];
   }
   if(lat!=0){
   //console.log(lat);
   //console.log(long);
   //console.log(ltc);
   //console.log(max_stat);
   //console.log(750000*ltc/max_stat);

 var infowindow = new google.maps.InfoWindow({});
 var marker = new google.maps.Marker({
     map: map
 });
 var title= country+'<br/>'+numberWithSpaces(ltc);
   var dot = new google.maps.LatLng(lat, long);
     var circle = new google.maps.Circle({
             center: dot,
             map: map,
             radius: 50000+1000000*ltc/max_stat,          // IN METERS.
             fillColor: '#FF6600',
             title: title,
             fillOpacity: 0.3,
             strokeColor: "#FFF",
             strokeWeight: 0         // DON'T SHOW CIRCLE BORDER.
         });

         google.maps.event.addListener(circle, 'mouseover', function () {
  if (typeof this.title !== "undefined") {
     marker.setPosition(this.getCenter()); // get circle's center
     infowindow.setContent("<b>" + this.title + "</b>"); // set content
     infowindow.open(map, marker); // open at marker's location
     marker.setVisible(false); // hide the marker
    }
 });

 google.maps.event.addListener(circle, 'mouseout', function () {
  infowindow.close();
 });
   }
  // break;
 }
 infoWindow = new google.maps.InfoWindow();
   const locationButton = document.createElement("button");
   locationButton.textContent = "Pan to Current Location";
   locationButton.classList.add("custom-map-control-button");
   map.controls[google.maps.ControlPosition.TOP_CENTER].push(locationButton);
   locationButton.addEventListener("click", () => {
     // Try HTML5 geolocation.
     if (navigator.geolocation) {
       navigator.geolocation.getCurrentPosition(
         (position) => {
           const pos = {
             lat: position.coords.latitude,
             lng: position.coords.longitude,
           };
           infoWindow.setPosition(pos);
           infoWindow.setContent("Location found.");
           infoWindow.open(map);
           map.setCenter(pos);
         },
         () => {
           handleLocationError(true, infoWindow, map.getCenter());
         }
       );
     } else {
       // Browser doesn't support Geolocation
       handleLocationError(false, infoWindow, map.getCenter());
     }
   });
     }

 function handleLocationError(browserHasGeolocation, infoWindow, pos) {
   infoWindow.setPosition(pos);
   infoWindow.setContent(
     browserHasGeolocation
       ? "Error: The Geolocation service failed."
       : "Error: Your browser doesn't support geolocation."
   );
   infoWindow.open(map);
 }

     google.maps.event.addDomListener(window, 'load', initialize);
     function numberWithSpaces(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
}
 </script>
<div class="overlay"></div>
 </body>

 </html>